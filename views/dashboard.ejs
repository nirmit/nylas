<!DOCTYPE html>

<html lang='en'>
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Dashboard</title>
	<link rel="stylesheet" type="text/css" href="/styles/jquery.filter.css" />
	<link rel="stylesheet" type="text/css" href="/styles/dataportal.css" />
	<link rel="stylesheet" type="text/css" href="/styles/gapi.css" />
	<link rel="stylesheet" type="text/css" href="/styles/media_query.css" />
	<link rel="stylesheet" type="text/css" href="/styles/style.css" />
	<script type="text/javascript" src="/js/jquery.js"></script>
	<script type="text/javascript" src="/js/jquery-ui.js"></script>
	<script src="/js/jquery.validate.min.js" type="text/javascript"></script>

	<script type="text/javascript">
	function fun_hide_msg()
	{
		setTimeout(function() {   //calls click event after a certain time
		   $('.close').click();
		}, 5000);
	}

	// go to list page
	function backtolist()
	{
		window.location.href = "http://gapi.anilabsinc.com/admin/dashboard";	
	}

	/* Function for pagination using AJAX to maintain serch area AND pagesize*/
	function show_ajax_cardswith_url(baseurl,fieldname,direction)
	{	
		var search_string = $('#search_string').val();
		
		$.ajax({
			url:baseurl,
			data:"baseurl="+baseurl+"&search_string="+search_string,
			type:'POST',
			success:function(res)
			{		 
				$('#table_listing').html($(res).find('#table_listing').html());			
			},
			error:function(res) 
			{
				result = false;			
			}
		});	
	} 

	/* Function for pagination using AJAX */
	function show_ajax_cards(obj)
	{
		var finalUrl;		
		var baseurl = obj.id;
		finalUrl = baseurl; // redirect
		
		var search_string = $('#search_string').val();
		
		$.ajax({
			url:finalUrl,
			data:"baseurl="+finalUrl+"&search_string="+search_string,	
			type:'POST',
			success:function(res)
			{
				$('#table_listing').html($(res).find('#table_listing').html());
				$('.research').accordion({header: '.mailinfo', collapsible: true, active: false, heightStyle: "content", icons: null});
			},
			error:function(res) 
			{
				result = false;			
			}
		});
	}
	 
	/* Function to select search area */
	function fun_clear()
	{	  
		$('#search_string').val('');
		$('#frm_search').submit();
		return false;
	} 

	$( document ).ajaxStart(function() {
		$("#loading").show();
	});

	$( document ).ajaxComplete(function() {
		$("#loading").hide();
	});

	function pullEmails(emailId,emailaddress)
	{
		var baseurl = 'http://gapi.anilabsinc.com/admin/emailmessages/pullemails';
		
		$.ajax({
			url:baseurl,
			data:{'email_id': emailId},
			type:'POST',
			success:function(res)
			{		 
				$('#successmsg').html('Email details have been pulled successfully for '+emailaddress+'.');
				fun_hide_msg();	
			},
			error:function(res) 
			{
				result = false;			
			}
		});
	}

	function pullCalEvents(emailId)
	{
		var baseurl = 'http://gapi.anilabsinc.com/admin/emailmessages/pullevents';
		
		$.ajax({
			url:baseurl,
			data:{'email_id': emailId},
			type:'POST',
			success:function(res)
			{		 
				$('#successmsg').html('Events have been pulled successfully.');
				fun_hide_msg();	
			},
			error:function(res) 
			{
				result = false;			
			}
		});
	}

	function switch_user(id,switcheduserid)
	{
		$( '#dialog-confirm-switch' ).dialog
		({
			height:170,
			resizable:false,
			width: 350,
			modal: true,
			closeText: "hide",
			draggable: false,
			buttons: 
			{
				"Yes": function() 
				{		
					var base_url = 'http://gapi.anilabsinc.com/admin/dashboard';
					var switchURL = base_url+"/switchtouser/";
					
					$.ajax({
						type: 'POST',
						url:switchURL,
						data:{'id': id,'switcheduserid':switcheduserid},
						success:function(data)
						{						
							window.location.href = "http://gapi.anilabsinc.com/admin/dashboard";
						},
						error:function(data)
						{
							result = false;
							document.getElementById('alert-success').style.display = 'none';
							document.getElementById('alert-danger').style.display = 'block';
							$('#dangermsg').html('Error While Switching User.');
							fun_hide_msg();
						},
					});
					$( this ).dialog( "close" );	
				},
				No: function() 
				{
					$( this ).dialog( "close" );
				}
			}
		});	
	}

	function delete_data(id,imgname='',module='')
	{
		if(module=='emailmessages')
		{
			$( '#dialog-confirm-emails' ).dialog
			({
				height:170,
				resizable:false,
				width: 350,
				modal: true,
				closeText: "hide",
				draggable: false,
				buttons: 
				{
					"Delete": function() 
					{		
						var base_url = 'http://gapi.anilabsinc.com/admin/dashboard';
						var deleteURL = base_url+"/delete/";
						
						$.ajax({
							type: 'POST',
							url:deleteURL,
							data:{'id': id,'img':imgname},
							success:function(data)
							{
								show_ajax_cardswith_url(base_url);
								$('tr[data-id='+id+']').remove();
								document.getElementById('alert-danger').style.display = 'none';
								document.getElementById('alert-success').style.display = 'block';
								$('#successmsg').html(data+' Deleted Successfully.');
								fun_hide_msg();
							},
							error:function(data)
							{
								//alert("No===>"+data);
								result = false;
								document.getElementById('alert-success').style.display = 'none';
								document.getElementById('alert-danger').style.display = 'block';
								$('#dangermsg').html('Error While Deleting Data.');
								fun_hide_msg();
							},
						});
						$( this ).dialog( "close" );		
					},
					Cancel: function() 
					{
						$( this ).dialog( "close" );
					}
				}
			});	
		}
		else
		{
			$( '#dialog-confirm' ).dialog
			({
				height:170,
				resizable:false,
				width: 350,
				modal: true,
				closeText: "hide",
				draggable: false,
				buttons: 
				{
					"Delete": function() 
					{		
						var base_url = 'http://gapi.anilabsinc.com/admin/dashboard';
						var deleteURL = base_url+"/delete/";
						
						$.ajax({
							type: 'POST',
							url:deleteURL,
							data:{'id': id,'img':imgname},
							success:function(data)
							{
								show_ajax_cardswith_url(base_url);
								$('tr[data-id='+id+']').remove();
								document.getElementById('alert-danger').style.display = 'none';
								document.getElementById('alert-success').style.display = 'block';
								$('#successmsg').html('Data Deleted Successfully.');
								fun_hide_msg();
							},
							error:function(data)
							{
								//alert("No===>"+data);
								result = false;
								document.getElementById('alert-success').style.display = 'none';
								document.getElementById('alert-danger').style.display = 'block';
								$('#dangermsg').html('Error While Deleting Data.');
								fun_hide_msg();
							},
						});
						$( this ).dialog( "close" );		
					},
					Cancel: function() 
					{
						$( this ).dialog( "close" );
					}
				}
			});	
		}	
	}

	</script>

</head>

<body>
	<header>
	<a href="/dashboard/index">
	<img alt="GAPI" class="hdr-logo" src="" />
	</a>
	<div class="welcome-name"><img alt="Sandeep Kumar" src="" width="50" /></div>
    <div class="welcome-name"><a data-method="delete" href="/logout" rel="nofollow">Log Out</a></div>
    </header>
	
	<div class="abc">
		<section>
			<div class="block">
				<a href="/user/show"><div class="home-box user"><h1>Users</h1></div></a>
				<a href="/mailboxes/index"><div class="home-box mail-box"><h1>Mail box</h1></div></a>
				<a href="javascript:void(0)"><div class="home-box email-message"><h1>Email Messages</h1></div></a>
				<a href="javascript:void(0)"><div class="home-box cal-event"><h1>Calendar Events</h1></div></a>
				<a href="/reports/index"><div class="home-box reports"><h1>Reports</h1></div></a>
			</div>
		</section>
	</div>

	<footer>
		<a href="www.anilabsinc.com" target="_blank">anilabsinc.com</a> <span>|</span> 
		<a data-method="delete" href="/logout" rel="nofollow">Log Out</a>
    </footer>
</body>

</html>